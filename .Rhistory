labs(y = "국적별 구성",
x = "trade-off(δ)") +
ggsave("14_2_최적다양성_engagement.png", height = 6, width = 7)
p_optimal_list_gpa %>%
bind_rows() %>%
mutate(국적 = performance_criteria$국적) %>%
mutate(국적 = fct_reorder(국적, `0`)) %>%
pivot_longer(`0`:`800`, names_to = "delta", values_to = "p") %>%
arrange(delta) %>%
select(delta, p, 국적) %>%
mutate(num = as.numeric(delta)) %>%
filter(num >= 0.0001, num<= 25) %>%
mutate(delta = fct_reorder(delta, num)) %>%
ggplot(aes(num, p, fill = 국적, group = 국적)) +
geom_area(color = "black") +
scale_fill_brewer(palette = "Spectral") +
scale_x_continuous(trans = log10_trans(),
breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),
expand = c(0, 0, 0, 0)) +
scale_y_continuous(expand = c(0, 0, 0, 0), labels = percent_format()) +
theme_minimal() +
labs(y = "국적별 구성",
x = "trade-off(δ)") +
ggsave("14_1_최적다양성_gpa.png", height = 6, width = 7)
p_optimal_list_gpa %>%
bind_rows() %>%
mutate(국적 = performance_criteria$국적) %>%
mutate(국적 = fct_reorder(국적, `0`)) %>%
pivot_longer(`0`:`800`, names_to = "delta", values_to = "p") %>%
arrange(delta) %>%
select(delta, p, 국적) %>%
mutate(num = as.numeric(delta)) %>%
filter(num >= 0.001, num<= 25) %>%
mutate(delta = fct_reorder(delta, num)) %>%
ggplot(aes(num, p, fill = 국적, group = 국적)) +
geom_area(color = "black") +
scale_fill_brewer(palette = "Spectral") +
scale_x_continuous(trans = log10_trans(),
breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),
expand = c(0, 0, 0, 0)) +
scale_y_continuous(expand = c(0, 0, 0, 0), labels = percent_format()) +
theme_minimal() +
labs(y = "국적별 구성",
x = "trade-off(δ)") +
ggsave("14_1_최적다양성_gpa.png", height = 6, width = 7)
성적변화도 %>%
ggplot(aes(지역, 국적_slope)) +
geom_point(aes(size = n), alpha = 0.5) +
geom_point(aes(지역, 지역_slope, fill = 지역_slope), size = 3, shape = 21, color = "black") +
scale_fill_gradient(high = "#ae0e36", low = "grey20")  +
theme_minimal() +
theme(legend.position = "none") +
ggrepel::geom_text_repel(aes(label = 국적), size = 1) +
labs(y = "학기 당 성적 변화(slope)") +
coord_flip() +
ggsave("13_국적_slope.png", height = 4, width = 6)
knitr::opts_chunk$set(echo = T, message = F, warning = F, cache=F)
library(tidyverse)
theme_set(theme_light()) # change default plot theme
# source("./W2_script.r", encoding = 'utf-8')
knitr::include_graphics(c("https://t1.daumcdn.net/cfile/tistory/2135314A58BCE2EF07"))
knitr::include_graphics(c("https://t1.daumcdn.net/cfile/tistory/2135314A58BCE2EF07"))
knitr::opts_chunk$set(echo = T, message = F, warning = F, cache=T)
library(tidyverse)
theme_set(theme_light()) # change default plot theme
# source("./W2_script.r", encoding = 'utf-8')
example <- tibble(몸무게 = seq(60:80, by = 2))
example <- tibble(몸무게 = seq(60,80, by = 2))
example
example <- tibble(몸무게 = seq(62,70, by = 2))
example
비만 = c(0, 0, 1, 1, 1))
example <- tibble(몸무게 = seq(62,70, by = 2),
비만 = c(0, 0, 1, 1, 1))
example
ggplot(example, aes(몸무게, 비만)) +
geom_point()
example <- tibble(몸무게 = seq(62,65, by = 1),
비만 = c(0, 0, 1, 1, 1))
example <- tibble(몸무게 = seq(62,66, by = 1),
비만 = c(0, 0, 1, 1, 1))
ggplot(example, aes(몸무게, 비만)) +
geom_point()
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F)
example <- tibble(몸무게 = seq(62,66, by = 1),
비만 = c(0, 0, 1, 1, 1)) %>%
mutate(비만 = as.factor(비만))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F)
example <- tibble(몸무게 = seq(62,66, by = 1),
비만 = c(0, 0, 1, 1, 1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(breaks = 1)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(breaks = 2)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(breaks = 2, labels = c(0, 1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(labels = c(0, 1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(breaks = 2, labels = c(0, 1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(breaks = 1, labels = c(0, 1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), breaks = 1, labels = c(0, 1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), breaks = 1)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), breaks = 1, labels = c(0, 1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), breaks = 1)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), breaks = 0.5)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), breaks = 1)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), labels = c("0", "","","",1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))
example <- tibble(몸무게 = seq(82,86, by = 1),
비만 = c(0, 0, 1, 1, 1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_x_continuous(limits = c(60,90)) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_x_continuous(limits = c(80,88)) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))
example <- tibble(몸무게 = c(60, 61, 80, 81, 82)),
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_x_continuous(limits = c(80,88)) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))
example <- tibble(몸무게 = c(60, 61, 80, 81, 82),
비만 = c(0, 0, 1, 1, 1))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_x_continuous(limits = c(80,88)) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))
?geom_line
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F, color = "slateblue") +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato")
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F, color = "skyblue") +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato")
ggplot(example, aes(몸무게, 비만), size = 2) +
geom_point() +
geom_smooth(method = "lm", se= F, color = "skyblue") +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato")
ggplot(example, aes(몸무게, 비만), size = 5) +
geom_point() +
geom_smooth(method = "lm", se= F, color = "skyblue") +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato")
ggplot(example, aes(몸무게, 비만, size = 5)) +
geom_point() +
geom_smooth(method = "lm", se= F, color = "skyblue") +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato")
ggplot(example, aes(몸무게, 비만, size = 2)) +
geom_point() +
geom_smooth(method = "lm", se= F, color = "skyblue") +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato")
ggplot(example, aes(몸무게, 비만, size = 1.5)) +
geom_point() +
geom_smooth(method = "lm", se= F, color = "skyblue") +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato")
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F, color = "skyblue") +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato")
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato")
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato", size = 2)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato", size = 2)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato", size = 2)
ggplot(example, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato", size = 2)
example_added <- example %>% bind_rows(120, 1)
example_added <- example %>% bind_rows(c(120, 1))
example_added <- example %>% bind_rows(data.frame(몸무게 = 120, 비만 = 1))
ggplot(example_added, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato", size = 2)
example_added <- example %>% bind_rows(data.frame(몸무게 = 100, 비만 = 1))
ggplot(example_added, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "lm", se= F) +
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))+
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato", size = 2)
p <- seq(0, 1, by = 0.1)
p
odds_p <- p / (1 - p)
odds_p
plot(odds_p)
plot(log(odds_p))
p <- seq(0, 1, by = 0.01)
odds_p <- p / (1 - p)
plot(odds_p)
plot(log(odds_p))
knitr::opts_chunk$set(echo = F, message = F, warning = F, cache=T)
library(tidyverse)
theme_set(theme_light()) # change default plot theme
# source("./W2_script.r", encoding = 'utf-8')
par(mfrow=c(1, 2))
p_list <- seq(0, 1, by = 0.01)
p_ <- seq(0, 1, by = 0.01)
par(mfrow=c(1, 2))
plot(p)
plot((p)/(1-p))
p_ <- seq(0, 1, by = 0.00001)
p_ <- seq(0, 1, by = 0.00001)
par(mfrow=c(1, 2))
plot(p)
plot((p)/(1-p))
p <- seq(0, 1, by = 0.00001)
par(mfrow=c(1, 2))
plot(p)
plot((p)/(1-p))
p <- seq(0, 1, by = 0.001)
p <- seq(0, 1, by = 0.001)
par(mfrow=c(1, 2))
plot(p)
plot((p)/(1-p))
p <- seq(0, 1, by = 0.01)
par(mfrow=c(1, 2))
plot(p)
plot((p)/(1-p))
p <- seq(0, 1, by = 0.01)
par(mfrow=c(1, 2))
plot(p)
title("p의 분포")
plot((p)/(1-p))
title("Odds(p)의 분포")
par(mfrow=c(1, 3))
plot(p)
title("p의 분포")
plot((p)/(1-p))
title("Odds(p)의 분포")
plot(log(p/(1-p)))
title("logit(p)의 분포")
par(mfrow=c(1, 3))
plot(p, p)
title("p의 분포")
plot((p)/(1-p))
title("Odds(p)의 분포")
plot(log(p/(1-p)))
title("logit(p)의 분포")
par(mfrow=c(1, 3))
plot(p, p)
title("p의 분포")
plot((p)/(1-p), p)
title("Odds(p)의 분포")
plot(log(p/(1-p)))
title("logit(p)의 분포")
par(mfrow=c(1, 3))
plot(p, p)
title("p의 분포")
plot((p)/(1-p), p)
title("Odds(p)의 분포")
plot(log(p/(1-p)), p)
title("logit(p)의 분포")
par(mfrow=c(1, 3))
plot(p, p)
title("p의 분포")
plot(p, (p)/(1-p))
title("Odds(p)의 분포")
plot(p, log(p/(1-p)))
title("logit(p)의 분포")
ggplot(example_added, aes(뭄무게, 비만)) +
geom_smooth(method = "binomial")
ggplot(example_added, aes(뭄무게, 비만)) +
geom_smooth(method = "logit")
example_added
example_added
ggplot(example_added, aes(뭄무게, 비만)) +
geom_smooth(method = "logit")
ggplot(example_added, aes(뭄무게, 비만))
ggplot(example_added, aes("뭄무게", "비만"))
example_added
ggplot(example_added, aes(몸무게, 비만)) +
geom_smooth(method = "binomial")
ggplot(example_added, aes(몸무게, 비만)) +
geom_smooth(method = "logit")
ggplot(example_added, aes(몸무게, 비만)) +
binomial_smooth()
ggplot(example_added, aes(몸무게, 비만)) +
geom_smooth(method = "glm", method.args = list(family = "binomial"))
ggplot(example_added, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "binomial"))
ggplot(example_added, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se =F)
ggplot(example_added, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se =F,
color = "tomato")
ggplot(example_added, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se =F)
ggplot(example_added, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se =F) +
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato", size = 2)
par(mfrow=c(1, 3))
plot(p, p)
title("p의 분포")
plot(p, (p)/(1-p))
title("Odds(p)의 분포")
plot(p, log(p/(1-p)))
title("logit(p)의 분포")
glm(비만 ~ 몸무게, example_added, family(binomial))
glm(비만 ~ 몸무게, example_added, family="binomial")
glm(비만 ~ 몸무게, example_added, family="binomial") %>%
summary()
x = example_added$몸무게
plot(x,(b*x+w))
x = example_added$몸무게
plot(x,(w*x+b))
b = -176.709
w = 2.502
x = example_added$몸무게
plot(x,(w*x+b))
abline(y = w*x+b)
?abline
abline(a = b, b = w)
x = example_added$몸무게
plot(x,(w*x+b)) +
abline(a = b, b = w)
x = example_added$몸무게
plot(x,(w*x+b)) +
abline(a = b, b = w, col = "blue")
knitr::opts_chunk$set(echo = F, message = F, warning = F, cache=F)
library(tidyverse)
theme_set(theme_light()) # change default plot theme
# source("./W2_script.r", encoding = 'utf-8')
x = example_added$몸무게
plot(x,(1 / (1 + (e^-(w*x+b)))))
plot(x,(1 / (1 + (-exp(w*x+b)))))
plot(x,(1 / (1 + (exp(-(w*x+b))))))
plot(x,(1 / (1 + (exp(-(w*x+b)))))) +
curve((1 / (1 + (exp(-(w*x+b))))))
curve((1 / (1 + (exp(-(w*x+b))))))
plot(x,(1 / (1 + (exp(-(w*x+b)))))) +
curve(x, (1 / (1 + (exp(-(w*x+b))))))
curve(x, (1 / (1 + (exp(-(w*x+b))))))
curve((1 / (1 + (exp(-(w*x+b))))), x)
plot(x, (1 / (1 + (exp(-(w*x+b))))))
sigmoid = function(x) {1 / (1 + exp(-(w*x + b)))  }
curve(sigmode, from = 0, to = 100)
curve(sigmoid, from = 0, to = 100)
curve(sigmoid, from = 60, to = 100)
plot(x, (1 / (1 + (exp(-(w*x+b))))))  +
curve(sigmoid, from = 60, to = 100)
curve(sigmoid, from = 60, to = 100)
curve(sigmoid, from = 60, to = 100, add=T)
plot(x, (1 / (1 + (exp(-(w*x+b))))))
curve(sigmoid, from = 60, to = 100, add=T)
plot(x, (1 / (1 + (exp(-(w*x+b))))), add = T)
curve(sigmoid, from = 60, to = 100, add = T)
curve(sigmoid, from = 60, to = 100, add = T) +
plot(x, (1 / (1 + (exp(-(w*x+b))))), add = T)
curve(sigmoid, from = 60, to = 100, add = T)
plot(x, (1 / (1 + (exp(-(w*x+b))))), add = T)
sigmoid = function(x) {1 / (1 + exp(-(w*x + b)))  }
curve(sigmoid, from = 60, to = 100, add = T)
ggplot(example_added, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se =F) +
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato", size = 2)
ggplot(example_added, aes(몸무게, 비만)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se =F) +
geom_hline(yintercept = 0.5, linetype = 2, color = "tomato", size = 2)+
scale_y_continuous(limits = c(0,1), labels = c("(정상) 0", "","","","(비만) 1"))
p <- seq(0, 1, by = 0.01)
par(mfrow=c(1, 2))
plot(p, p)
title("p의 분포")
plot(p, (p)/(1-p))
title("Odds(p)의 분포")
lm(비만~몸무게,example)
lm(비만~몸무게,example) %>%
summary()
lm(비만~몸무게,example) %>%
summary()
plot(example_added$몸무게)
example_added$몸무게
x = example_added$몸무게
plot(x,(theta_1*x+theta_0)) +
abline(a = theta_0, b = theta_1, col = "blue")
glm(비만 ~ 몸무게, example_added, family="binomial") %>%
summary()
theta_0 = -176.709
theta_1 = 2.502
x = example_added$몸무게
plot(x,(theta_1*x+theta_0)) +
abline(a = theta_0, b = theta_1, col = "blue")
z <- seq(-100, 100, by = 1)
plot(z, (1/1+exp(-z)))
z <- seq(-100, 100, by = 1)
z
1 / (1 + exp(-(z))
1 / (1 + exp(-(z)))
z <- seq(-10, 10, by = 0.1)
z
plot(z, (1/1+exp(-z)))
1 / (1 + exp(-(z)))
plot(z, (1/1+exp(-(z))))
plot(z, (1/1+exp(-(z))))
plot(z, (1/(1+exp(-(z)))))
z <- seq(-10, 10, by = 0.1)
plot(z, (1/(1+exp(-(z)))))
abline(x = 0)
abline(a = 0.5, b = 0)
abline(a = 0.5, b = 0, add =T)
plot(z, (1/(1+exp(-(z))))) +
abline(a = 0.5, b = 0)
plot(z, (1/(1+exp(-(z))))) +
abline(a = 0.5, b = 0) +
abline(a = 0, b = 1)
plot(z, (1/(1+exp(-(z))))) +
abline(a = 0.5, b = 0)
plot(z, (1/(1+exp(-(z))))) +
abline(a = 0.5, b = 0)  +
abline(v = 0)

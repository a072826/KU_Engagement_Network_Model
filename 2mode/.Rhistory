ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~국적, scale="free_y", ncol = 5)
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_density(binwidth = 0.1) +
facet_wrap(대학~국적, scale="free_y", ncol = 5)
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_density() +
facet_wrap(대학~국적, scale="free_y", ncol = 5)
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_density() +
facet_wrap(대학~국적, scale="free_y", ncol = 6)
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_density() +
facet_wrap(대학~국적, scale="free_y", ncol = 6) +
scale_y_continuous(limits = c(0,1))
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~국적, scale="free_y", ncol = 5)
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~국적, scale="free_y", ncol = 5) +
stat_summary(fun.x = mean, geom = "line", lwd =2)
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~국적, scale="free_y", ncol = 5) +
stat_summary(fun.y = mean, geom = "line", lwd =2)
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~국적, scale="free_y", ncol = 5)
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학", "디자인조형학부")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~국적, scale="free_y", ncol = 5)
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학", "공과대학")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~국적, scale="free_y", ncol = 5)
attributes <- c("성별", "입학유형")
optimum_raw <- student_info_for_idx %>%
select(-학점) %>%  # 네트워크 데이터에서 넘어온 학점 제거
filter(학적상태 %in% c("졸업", "조기졸업")) %>%
filter(!grepl("편입", 입학유형)) %>%
filter(입학년도 >= 2000) %>%
filter(졸업년도 >= 2000) %>%
mutate(perspective = paste(입학년도, 대학, sep = "_")) %>%
mutate(다전공이름 = case_when(다전공종류=="심화전공"~학과,
다전공종류=="이중전공"~이중전공,
다전공종류=="융합전공"~융합전공)) %>%
# mutate(국적 = fct_lump(국적, n = 20))  %>%
# unite_("element", c(attributes[1], attributes[2]), sep = "|")
mutate_(element = attributes[2]) %>%
left_join(std_gpa_record_final %>%
select(식별자, 학점_증명용, 학점, 신청학점, 이수학점), by = "식별자")
element_p <- optimum_raw %>%
select_if(names(.) %in% c("element", criteria, "perspective")) %>%
group_by(perspective) %>%
mutate(N_year = sum(n())) %>%
group_by(perspective, N_year) %>%
count(element) %>%
mutate(p = n / N_year)  %>%
group_by(perspective) %>%
mutate(Num_row = 1:n(),
Num_element = n()) %>%
ungroup()
optimum_temp <- optimum_raw %>%
group_by(perspective) %>%
select_if(names(.) %in% c("element", criteria)) %>%
replace(is.na(.), 0) %>%
group_by(perspective, element) %>%
summarise_at(.vars = criteria, .funs = c(mean = "mean"), na.rm=T) %>%
group_by(perspective) %>%
mutate(Num_row = 1:n()) %>%
ungroup()
attribute_d <- optimum_temp %>%
mutate_at(vars(contains("mean")), ~scale(.)) %>% # 전체 기록 바탕으로 element별 difference 계산
group_split(perspective) %>%
setNames(unique(sort(as.character(optimum_temp$perspective)))) %>%
map(~ select(.x, -element, -perspective) %>%
column_to_rownames(var = "Num_row") %>%
proxy::dist(method = "Euclidean") %>%
as.matrix() %>%
reshape2::melt(varnames = c("row", "col"))) %>%
map_df(~as.data.frame(.x), .id = "perspective") %>%
left_join(element_p %>% select(element, Num_row, p, perspective), by = c("row" = "Num_row", "perspective")) %>%
rename(row_element = element,
p_row = p) %>%
left_join(element_p %>% select(element, Num_row, p, perspective), by = c("col" = "Num_row", "perspective")) %>%
rename(col_element = element,
p_col = p,
d = value)  %>%
as_tibble()
diversity_matrix <- attribute_d %>%
group_by(perspective) %>%
filter(n() < 2 | row > col) %>%  # variety가 1이면 유지. 2이상이면, lower_diagonal만 남김
separate(perspective, c("입학년도", "대학"), "_") %>%
ungroup()
diversity_data <-  diversity_matrix %>%
group_by(입학년도, 대학) %>%
summarise(variety = max(row),  # scaled variety
balance = 2 * sum(p_row * p_col),  # balence-weighted variety
diversity = sum(d * p_row * p_col))  %>% # balance/disparity-weighted variety
mutate(balance = case_when(variety ==1 ~ 0,
TRUE ~ balance)) %>%
arrange(-diversity) %>%
ungroup()
heuristic_data <- diversity_data %>%
filter(입학년도 < 2016) %>%
mutate(입학년도 = as.numeric(입학년도)) %>%
# mutate(variety = as.factor(variety)) %>%
filter(!대학 %in% c("법과대학", "정보통신대학"))
library(gganimate)
temp_color = colorRampPalette(brewer.pal(11,"Spectral"))(16)
d_balance_by_diversity <- heuristic_data %>%
rename(x = balance,
y = diversity,
group = 대학) %>%
mutate(입학년도 = as.numeric(입학년도)) %>%
filter(!group %in% c("법과대학"))
balance_by_diversity_order <- d_balance_by_diversity %>%
group_by(group) %>%
do(tidy(lm(y ~ x, data=.))) %>%
mutate(n_term = n()) %>%
filter(n_term == 1 | term != "(Intercept)") %>%
arrange(-estimate)  %>%
ungroup() %>%
mutate(order = 1:n())
p_balance_by_diversity <- d_balance_by_diversity %>%
left_join(balance_by_diversity_order %>% select(group, order), by = "group") %>%
mutate(group = fct_reorder(group, order)) %>%
ggplot(aes(x, y, color = group,
fill = group, group = group,
alpha = 입학년도 - min(입학년도) / max(입학년도))) +
geom_line() +
geom_point(aes(group = seq_along(입학년도),
size = variety),  # 점들이 순차적으로 등장하게 만들기 위해서 필요
shape = 21, color = "white") +
scale_fill_manual(name = "College (대학)", values = temp_color) +
scale_color_manual(name = "College (대학)", values = temp_color) +
scale_size_continuous(range = c(1, 4)) +
scale_alpha_continuous(range = c(0.1, 1)) +
scale_y_continuous(limits = c(0, NA)) +
ggdark::dark_theme_minimal() +
theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~group, ncol=5)  +
guides(alpha = F, fill = F, color = F) +
# guides(fill = guide_legend(override.aes = list(size=4, linetype = 0))) +
labs(x = "Balance (균등성, 0=완전불균형, 1=완전균형)",
y = "Diversity (다양성)",
size = "Variety (다종성)") +
geom_smooth(formula = y ~ x, method = "lm", linetype=3,
size = 0.5, color = "white", se = F, fullrange = T)
optimum_raw %>%
filter(대학 %in% c("정경대학", "의과대학", "공과대학")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~국적, scale="free_y", ncol = 5)
ggsave(p_balance_by_diversity, filename = "p_balance_by_diversity.png", dpi = 300, width = 6, height = 5)
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(국적 = fct_lump(국적, n = 4, other_level = "기타")) %>%
group_by(국적) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(국적 = fct_reorder(국적, -n)) %>%
ggplot(aes(학점_증명용, fill = 국적)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~국적, scale="free_y", ncol = 5)
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5)
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5) +
geom_vline(xintercept = mean(x))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_histogram(binwidth = 0.1, aes(y = ..density..)) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5) +
geom_vline(xintercept = mean(x))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_histogram(binwidth = 0.1, aes(y = ..density..)) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5)
geom_vline(xintercept = mean(학점_증명용))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5) +
geom_vline(xintercept = mean(학점_증명용))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean(학점_증명용)))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_histogram(binwidth = 0.1) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_density(aes(y = ..count.. * bin), fill = "blue", alpha = 0.3) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_density(aes(y = ..count.. * bin), fill = "blue", alpha = 0.3) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5)
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용)) +
geom_density(aes(y = ..count.. * bin), fill = "blue", alpha = 0.3) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5)
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n()) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용)) +
geom_density(aes(y = ..count.. * bin), fill = "blue", alpha = 0.3)
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n(),
mean = mean(학점_증명용)) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_density(binwidth = 0.1) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n(),
mean = mean(학점_증명용, na.rm=T)) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_density(binwidth = 0.1) +
facet_wrap(대학~입학유형, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n(),
mean = mean(학점_증명용, na.rm=T)) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형, color = 입학유형)) +
geom_density(alpha = 0.3) +
facet_wrap(~대학, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n(),
mean = mean(학점_증명용, na.rm=T)) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형, col = 입학유형)) +
geom_density(alpha = 0.3) +
facet_wrap(~대학, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n(),
mean = mean(학점_증명용, na.rm=T)) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형, colour = 입학유형)) +
geom_density(alpha = 0.3) +
facet_wrap(~대학, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean))
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n(),
mean = mean(학점_증명용, na.rm=T)) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형, colour = 입학유형)) +
geom_density(alpha = 0.3) +
facet_wrap(~대학, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean), size = 3)
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n(),
mean = mean(학점_증명용, na.rm=T)) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형, color = 입학유형)) +
geom_density(alpha = 0.3) +
facet_wrap(~대학, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean), size = 3)
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n(),
mean = mean(학점_증명용, na.rm=T)) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형, color = 입학유형)) +
geom_density(alpha = 0.3) +
facet_wrap(~대학, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean), size = 3, color = "blue")
optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n(),
mean = mean(학점_증명용, na.rm=T)) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_density(alpha = 0.3) +
facet_wrap(~대학, scale="free_y", ncol = 5) +
geom_vline(aes(xintercept = mean, color = 입학유형), size = 2)
p <- optimum_raw %>%
filter(대학 %in% c("미디어학부", "국제학부")) %>%
group_by(대학) %>%
mutate(입학유형 = fct_lump(입학유형, n = 4, other_level = "기타")) %>%
group_by(입학유형) %>%
mutate(n = n(),
mean = mean(학점_증명용, na.rm=T)) %>%
ungroup() %>%
mutate(입학유형 = fct_reorder(입학유형, -n)) %>%
ggplot(aes(학점_증명용, fill = 입학유형)) +
geom_density(alpha = 0.3) +
facet_wrap(~대학, scale="free_y", ncol = 5)
.myggplotly(p)
